# 1.         ℹ `Создайте Series с данными о продажах за неделю [120, 150, 90, 200, 180, 250, 300] (Пн-Вс) и выполните анализ`

```python
# загружаем библиотеки
```

```python
import pandas as pd
```

```python
import numpy as np
```

```python
import matplotlib.pyplot as plt
```

```python
from matplotlib.ticker import FuncFormatter
```

```python
sales = pd.Series([120, 150, 90, 200, 180, 250, 300], 
                  index = ["ПН", "ВТ", "СР", "ЧТ", "ПТ", "СБ", "ВС"], 
                  name = "Продажи") # Создан Series с данными о продажах за неделю
```

## 1А.        ✅`Выведите дни с продажами выше среднего`

```python
sales # Проверка продаж
```


    ПН    120
    ВТ    150
    СР     90
    ЧТ    200
    ПТ    180
    СБ    250
    ВС    300
    Name: Продажи, dtype: int64



```python
sales.mean() # Вывод среднего арифметического значения. Получаем среднее по продаж.
```


    np.float64(184.28571428571428)



```python
above_avg = sales[sales > sales.mean()]  # Продажи сравниваем со средним значением и выводим всё, что выше этого значения
```

```python
print('Дни с продажами выше среднего')
print(above_avg)
```

    Дни с продажами выше среднего
    ЧТ    200
    СБ    250
    ВС    300
    Name: Продажи, dtype: int64

## 1Б.        ✅`Найдите процентное соотношение продаж в выходные (Сб, Вс) к общим продажам`

```python
# новая переменная с общей суммой продаж
all_sum_values = sales.sum()
```

```python
# новая переменная с фильтром продаж по выходным
weeekend_sales = sales[['СБ', 'ВС']].sum()
```

```python
# процентное соотношение продаж в выходные (Сб, Вс) к общим продажам
percentage = (weeekend_sales/all_sum_values)*100
```

```python
print('Процентное соотношение продаж в выходные (Сб, Вс) к общим продажам:', '→',percentage,'←')
```

    Процентное соотношение продаж в выходные (Сб, Вс) к общим продажам: → 42.63565891472868 ←

# 2.        ℹ `Очистите DataFrame с "грязными" данными`

```python
data = {
    'Продукт': ['Яблоки', 'Груши', 'Бананы', np.nan, 'Апельсины', ''],
    'Цена': [100, 120, '90', 150, 'не число', 200],
    'Количество': [10, 15, 20, None, 25, 30]
}
```

## 2А.        ✅`Создание DataFrame с "грязными" данными`

```python
df = pd.DataFrame(data)
```

```python
print(df)
```

         Продукт      Цена  Количество
    0     Яблоки       100        10.0
    1      Груши       120        15.0
    2     Бананы        90        20.0
    3        NaN       150         NaN
    4  Апельсины  не число        25.0
    5                  200        30.0



```python
df
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Продукт</th>
      <th>Цена</th>
      <th>Количество</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Яблоки</td>
      <td>100</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Груши</td>
      <td>120</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Бананы</td>
      <td>90</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Неизвестно</td>
      <td>150</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Апельсины</td>
      <td>не число</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Неизвестно</td>
      <td>200</td>
      <td>30.0</td>
    </tr>
  </tbody>
</table>
</div>

## 2Б.        ✅`Замените пустые строки и NaN в столбце 'Продукт' на 'Неизвестно'`

```python
df ['Продукт'] = df ['Продукт'].replace(['', np.nan], 'Неизвестно') # Заменяем значение NaN в колонке Продукты на "Неизвестно"
```

```python
df
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Продукт</th>
      <th>Цена</th>
      <th>Количество</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Яблоки</td>
      <td>100</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Груши</td>
      <td>120</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Бананы</td>
      <td>90</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Неизвестно</td>
      <td>150</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Апельсины</td>
      <td>не число</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Неизвестно</td>
      <td>200</td>
      <td>30.0</td>
    </tr>
  </tbody>
</table>
</div>

```python
df.info
```


    <bound method DataFrame.info of       Продукт   Цена  Количество
    0      Яблоки  100.0        10.0
    1       Груши  120.0        15.0
    2      Бананы   90.0        20.0
    3  Неизвестно  150.0         NaN
    4   Апельсины    NaN        25.0
    5  Неизвестно  200.0        30.0>



## 2Б.        ✅`Преобразуйте столбец 'Цена' в числовой формат, ошибки замените на NaN`

```python
df ['Цена'] = pd.to_numeric(df ['Цена'], errors = 'coerce')
```

```python
df
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Продукт</th>
      <th>Цена</th>
      <th>Количество</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Яблоки</td>
      <td>100.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Груши</td>
      <td>120.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Бананы</td>
      <td>90.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Неизвестно</td>
      <td>150.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Апельсины</td>
      <td>NaN</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Неизвестно</td>
      <td>200.0</td>
      <td>30.0</td>
    </tr>
  </tbody>
</table>
</div>

## 2Г.        ✅`Заполните пропущенные значения в 'Количество' средним значением`

```python
mean_qty = df['Количество'].mean() # вывод количетсво
```

```python
mean_qty
```


    np.float64(20.0)



```python
df['Количество'] = df['Количество'].fillna(mean_qty)
```

```python
df
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Продукт</th>
      <th>Цена</th>
      <th>Количество</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Яблоки</td>
      <td>100.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Груши</td>
      <td>120.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Бананы</td>
      <td>90.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Неизвестно</td>
      <td>150.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Апельсины</td>
      <td>NaN</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Неизвестно</td>
      <td>200.0</td>
      <td>30.0</td>
    </tr>
  </tbody>
</table>
</div>

## 2Д.        ✅`Удалите строки, где цена не указана (NaN)`

```python
df = df.dropna(subset = 'Цена')
```

```python
df
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Продукт</th>
      <th>Цена</th>
      <th>Количество</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Яблоки</td>
      <td>100.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Груши</td>
      <td>120.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Бананы</td>
      <td>90.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Неизвестно</td>
      <td>150.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Неизвестно</td>
      <td>200.0</td>
      <td>30.0</td>
    </tr>
  </tbody>
</table>
</div>

# 3.        ℹ `Проанализируйте простой набор данных о фруктах и их ценах.`

```python
data = {
    'Фрукт': ['Яблоко', 'Банан', 'Апельсин', 'Груша', 'Киви'],
    'Цена': [80, 60, 90, 70, 120],
    'Наличие_кг': [15, 8, 12, 5, 3]
}
```

```python
df = pd.DataFrame(data)
```

```python
df # check
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Фрукт</th>
      <th>Цена</th>
      <th>Наличие_кг</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Яблоко</td>
      <td>80</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Банан</td>
      <td>60</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Апельсин</td>
      <td>90</td>
      <td>12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Груша</td>
      <td>70</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Киви</td>
      <td>120</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>

## 3А.        ✅`Выведите только фрукты дороже 75 рублей`

```python
fruits = df[df['Цена'] > 75]
```

```python
fruits # check
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Фрукт</th>
      <th>Цена</th>
      <th>Наличие_кг</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Яблоко</td>
      <td>80</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Апельсин</td>
      <td>90</td>
      <td>12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Киви</td>
      <td>120</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>

## 3Б.        ✅`Посчитайте общую стоимость всех имеющихся фруктов`

```python
df['Стоимость'] = df['Цена'] = df['Наличие_кг']
```

```python
df #check
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Фрукт</th>
      <th>Цена</th>
      <th>Наличие_кг</th>
      <th>Стоимость</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Яблоко</td>
      <td>15</td>
      <td>15</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Банан</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Апельсин</td>
      <td>12</td>
      <td>12</td>
      <td>12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Груша</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Киви</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>

```python
total = df['Стоимость'].sum()
```

```python
total
```


    np.int64(43)



## 3В.        ✅`Добавьте новый фрукт (Манго за 100 руб., 7 кг)`

```python
New_fruits = pd.DataFrame({ 
    'Фрукт': ['Манго'],
    'Цена': [100],
    'Наличие_кг': [7],
    'Стоимость': [700]
})
```

```python
df #check
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Фрукт</th>
      <th>Цена</th>
      <th>Наличие_кг</th>
      <th>Стоимость</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Яблоко</td>
      <td>15</td>
      <td>15</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Банан</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Апельсин</td>
      <td>12</td>
      <td>12</td>
      <td>12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Груша</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Киви</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>

```python
df = pd.concat([df, New_fruits], ignore_index = True) # Объединение двух df
```

```python
df
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Фрукт</th>
      <th>Цена</th>
      <th>Наличие_кг</th>
      <th>Стоимость</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Яблоко</td>
      <td>15</td>
      <td>15</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Банан</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Апельсин</td>
      <td>12</td>
      <td>12</td>
      <td>12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Груша</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Киви</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Манго</td>
      <td>100</td>
      <td>7</td>
      <td>700</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Манго</td>
      <td>100</td>
      <td>7</td>
      <td>700</td>
    </tr>
  </tbody>
</table>
</div>

## 3Г.        ✅`Отсортируйте фрукты по цене (от дешевых к дорогим)`

```python
df.sort_values('Цена')
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Фрукт</th>
      <th>Цена</th>
      <th>Наличие_кг</th>
      <th>Стоимость</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Киви</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Груша</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Банан</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Апельсин</td>
      <td>12</td>
      <td>12</td>
      <td>12</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Яблоко</td>
      <td>15</td>
      <td>15</td>
      <td>15</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Манго</td>
      <td>100</td>
      <td>7</td>
      <td>700</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Манго</td>
      <td>100</td>
      <td>7</td>
      <td>700</td>
    </tr>
  </tbody>
</table>
</div>

# 4.        ℹ `Исследование заёмщиков`

**Заказчик** - Кредитный отдел банка.

Согласно документации к данным:

* `children` — количество детей в семье;
* `days_employed` — общий трудовой стаж в днях;
* `dob_years` — возраст клиента в годах;
* `education` — уровень образования клиента;
* `education_id` — идентификатор уровня образования;
* `family_status` — семейное положение;
* `family_status_id` — идентификатор семейного положения;
* `gender` — пол клиента;
* `income_type` — тип занятости;
* `debt` — имел ли задолженность по возврату кредитов;
* `total_income` — ежемесячный доход;
* `purpose` — цель получения кредита.

ℹ **Дать ответы на вопросы:**

* 4А.   ❓`Средняя зарплата по типу занятости`;

* 4Б.   ❓`Процент заемщиков с высшим образованием`;

* 4В.   ❓`Частота кредитов на покупку жилья`;

* 4Г.   ❓`Зависимость между семейным положением и задолженностью`;

* 4Д.   ❓`Есть ли зависимость между количеством детей и возвратом кредита в срок?`;

* 4Е.   ❓`Есть ли зависимость между уровнем дохода и возвратом кредита в срок?`.

## ✅ Обзор данных

```python
df = pd.read_csv("data.csv")
```

```python
df
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education</th>
      <th>education_id</th>
      <th>family_status</th>
      <th>family_status_id</th>
      <th>gender</th>
      <th>income_type</th>
      <th>debt</th>
      <th>total_income</th>
      <th>purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>8437.673028</td>
      <td>42</td>
      <td>высшее</td>
      <td>0</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>253875.639453</td>
      <td>покупка жилья</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>4024.803754</td>
      <td>36</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>112080.014102</td>
      <td>приобретение автомобиля</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>5623.422610</td>
      <td>33</td>
      <td>Среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>M</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>145885.952297</td>
      <td>покупка жилья</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>3</td>
      <td>4124.747207</td>
      <td>32</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>M</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>267628.550329</td>
      <td>дополнительное образование</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>1630.019381</td>
      <td>53</td>
      <td>среднее</td>
      <td>1</td>
      <td>гражданский брак</td>
      <td>1</td>
      <td>F</td>
      <td>пенсионер</td>
      <td>0</td>
      <td>158616.077870</td>
      <td>сыграть свадьбу</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>21390</th>
      <td>21390</td>
      <td>1</td>
      <td>4529.316663</td>
      <td>43</td>
      <td>среднее</td>
      <td>1</td>
      <td>гражданский брак</td>
      <td>1</td>
      <td>F</td>
      <td>компаньон</td>
      <td>0</td>
      <td>224791.862382</td>
      <td>операции с жильем</td>
    </tr>
    <tr>
      <th>21391</th>
      <td>21391</td>
      <td>0</td>
      <td>1630.019381</td>
      <td>67</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>пенсионер</td>
      <td>0</td>
      <td>155999.806512</td>
      <td>сделка с автомобилем</td>
    </tr>
    <tr>
      <th>21392</th>
      <td>21392</td>
      <td>1</td>
      <td>2113.346888</td>
      <td>38</td>
      <td>среднее</td>
      <td>1</td>
      <td>гражданский брак</td>
      <td>1</td>
      <td>M</td>
      <td>сотрудник</td>
      <td>1</td>
      <td>89672.561153</td>
      <td>недвижимость</td>
    </tr>
    <tr>
      <th>21393</th>
      <td>21393</td>
      <td>3</td>
      <td>3112.481705</td>
      <td>38</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>M</td>
      <td>сотрудник</td>
      <td>1</td>
      <td>244093.050500</td>
      <td>на покупку своего автомобиля</td>
    </tr>
    <tr>
      <th>21394</th>
      <td>21394</td>
      <td>2</td>
      <td>1984.507589</td>
      <td>40</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>82047.418899</td>
      <td>на покупку автомобиля</td>
    </tr>
  </tbody>
</table>
<p>21395 rows × 13 columns</p>
</div>

```python
df.head(2) # output 2 lines
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education</th>
      <th>education_id</th>
      <th>family_status</th>
      <th>family_status_id</th>
      <th>gender</th>
      <th>income_type</th>
      <th>debt</th>
      <th>total_income</th>
      <th>purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>8437.673028</td>
      <td>42</td>
      <td>высшее</td>
      <td>0</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>253875.639453</td>
      <td>покупка жилья</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>4024.803754</td>
      <td>36</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>112080.014102</td>
      <td>приобретение автомобиля</td>
    </tr>
  </tbody>
</table>
</div>

```python
df.info #check general info
```


    <bound method DataFrame.info of        Unnamed: 0  children  days_employed  dob_years education  education_id  \
    0               0         1    8437.673028         42    высшее             0   
    1               1         1    4024.803754         36   среднее             1   
    2               2         0    5623.422610         33   Среднее             1   
    3               3         3    4124.747207         32   среднее             1   
    4               4         0    1630.019381         53   среднее             1   
    ...           ...       ...            ...        ...       ...           ...   
    21390       21390         1    4529.316663         43   среднее             1   
    21391       21391         0    1630.019381         67   среднее             1   
    21392       21392         1    2113.346888         38   среднее             1   
    21393       21393         3    3112.481705         38   среднее             1   
    21394       21394         2    1984.507589         40   среднее             1   

              family_status  family_status_id gender income_type  debt  \
    0       женат / замужем                 0      F   сотрудник     0   
    1       женат / замужем                 0      F   сотрудник     0   
    2       женат / замужем                 0      M   сотрудник     0   
    3       женат / замужем                 0      M   сотрудник     0   
    4      гражданский брак                 1      F   пенсионер     0   
    ...                 ...               ...    ...         ...   ...   
    21390  гражданский брак                 1      F   компаньон     0   
    21391   женат / замужем                 0      F   пенсионер     0   
    21392  гражданский брак                 1      M   сотрудник     1   
    21393   женат / замужем                 0      M   сотрудник     1   
    21394   женат / замужем                 0      F   сотрудник     0   

            total_income                       purpose  
    0      253875.639453                 покупка жилья  
    1      112080.014102       приобретение автомобиля  
    2      145885.952297                 покупка жилья  
    3      267628.550329    дополнительное образование  
    4      158616.077870               сыграть свадьбу  
    ...              ...                           ...  
    21390  224791.862382             операции с жильем  
    21391  155999.806512          сделка с автомобилем  
    21392   89672.561153                  недвижимость  
    21393  244093.050500  на покупку своего автомобиля  
    21394   82047.418899         на покупку автомобиля  

    [21395 rows x 13 columns]>



```python
df.describe()
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education_id</th>
      <th>family_status_id</th>
      <th>debt</th>
      <th>total_income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>21395.000000</td>
      <td>21395.000000</td>
      <td>19284.000000</td>
      <td>21395.000000</td>
      <td>21395.000000</td>
      <td>21395.000000</td>
      <td>21395.000000</td>
      <td>1.928400e+04</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>10697.000000</td>
      <td>0.470437</td>
      <td>2224.761599</td>
      <td>43.284272</td>
      <td>0.817107</td>
      <td>0.974246</td>
      <td>0.081000</td>
      <td>1.674178e+05</td>
    </tr>
    <tr>
      <th>std</th>
      <td>6176.348841</td>
      <td>0.754534</td>
      <td>2106.974155</td>
      <td>12.576030</td>
      <td>0.548879</td>
      <td>1.421282</td>
      <td>0.272842</td>
      <td>1.030418e+05</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>-1.000000</td>
      <td>24.141633</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.066726e+04</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5348.500000</td>
      <td>0.000000</td>
      <td>927.984311</td>
      <td>33.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.030161e+05</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>10697.000000</td>
      <td>0.000000</td>
      <td>1630.019381</td>
      <td>42.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.450208e+05</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>16045.500000</td>
      <td>1.000000</td>
      <td>2747.876441</td>
      <td>53.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>2.033700e+05</td>
    </tr>
    <tr>
      <th>max</th>
      <td>21394.000000</td>
      <td>5.000000</td>
      <td>18388.949901</td>
      <td>75.000000</td>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>2.265604e+06</td>
    </tr>
  </tbody>
</table>
</div>

```python
df['education'].unique() # checking for duplicates
```


    array(['высшее', 'среднее', 'Среднее', 'СРЕДНЕЕ', 'ВЫСШЕЕ',
           'неоконченное высшее', 'начальное', 'Высшее',
           'НЕОКОНЧЕННОЕ ВЫСШЕЕ', 'Неоконченное высшее', 'НАЧАЛЬНОЕ',
           'Начальное', 'Ученая степень', 'УЧЕНАЯ СТЕПЕНЬ', 'ученая степень'],
          dtype=object)



```python
df['education'].value_counts()  # подсчет количества людей и образование 
```


    education
    среднее                13653
    высшее                  4698
    СРЕДНЕЕ                  770
    Среднее                  705
    неоконченное высшее      666
    ВЫСШЕЕ                   271
    Высшее                   268
    начальное                250
    Неоконченное высшее       47
    НЕОКОНЧЕННОЕ ВЫСШЕЕ       29
    НАЧАЛЬНОЕ                 17
    Начальное                 15
    ученая степень             4
    Ученая степень             1
    УЧЕНАЯ СТЕПЕНЬ             1
    Name: count, dtype: int64



```python
for i in ['education', 'family_status', 'gender', 'income_type', 'purpose']: # цикл для проверки на уникльность
    print(df[i].unique())
```

    ['высшее' 'среднее' 'Среднее' 'СРЕДНЕЕ' 'ВЫСШЕЕ' 'неоконченное высшее'
     'начальное' 'Высшее' 'НЕОКОНЧЕННОЕ ВЫСШЕЕ' 'Неоконченное высшее'
     'НАЧАЛЬНОЕ' 'Начальное' 'Ученая степень' 'УЧЕНАЯ СТЕПЕНЬ'
     'ученая степень']
    ['женат / замужем' 'гражданский брак' 'вдовец / вдова' 'в разводе'
     'не женат / не замужем']
    ['F' 'M' 'XNA']
    ['сотрудник' 'пенсионер' 'компаньон' 'госслужащий' 'безработный'
     'предприниматель' 'студент' 'в декрете']
    ['покупка жилья' 'приобретение автомобиля' 'дополнительное образование'
     'сыграть свадьбу' 'операции с жильем' 'образование'
     'на проведение свадьбы' 'покупка жилья для семьи' 'покупка недвижимости'
     'покупка коммерческой недвижимости' 'покупка жилой недвижимости'
     'строительство собственной недвижимости' 'недвижимость'
     'строительство недвижимости' 'на покупку подержанного автомобиля'
     'на покупку своего автомобиля' 'операции с коммерческой недвижимостью'
     'строительство жилой недвижимости' 'жилье'
     'операции со своей недвижимостью' 'автомобили' 'заняться образованием'
     'сделка с подержанным автомобилем' 'получение образования' 'автомобиль'
     'свадьба' 'получение дополнительного образования' 'покупка своего жилья'
     'операции с недвижимостью' 'получение высшего образования'
     'свой автомобиль' 'сделка с автомобилем' 'профильное образование'
     'высшее образование' 'покупка жилья для сдачи' 'на покупку автомобиля'
     'ремонт жилью' 'заняться высшим образованием']



```python
df = df.drop(columns = ['Unnamed: 0']) # удаление ненужного столбца
```

```python
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 21395 entries, 0 to 21394
    Data columns (total 12 columns):
     #   Column            Non-Null Count  Dtype  
    ---  ------            --------------  -----  
     0   children          21395 non-null  int64  
     1   days_employed     19284 non-null  float64
     2   dob_years         21395 non-null  int64  
     3   education         21395 non-null  object 
     4   education_id      21395 non-null  int64  
     5   family_status     21395 non-null  object 
     6   family_status_id  21395 non-null  int64  
     7   gender            21395 non-null  object 
     8   income_type       21395 non-null  object 
     9   debt              21395 non-null  int64  
     10  total_income      19284 non-null  float64
     11  purpose           21395 non-null  object 
    dtypes: float64(2), int64(5), object(5)
    memory usage: 2.0+ MB



```python
df.describe()
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education_id</th>
      <th>family_status_id</th>
      <th>debt</th>
      <th>total_income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>21395.000000</td>
      <td>19284.000000</td>
      <td>21395.000000</td>
      <td>21395.000000</td>
      <td>21395.000000</td>
      <td>21395.000000</td>
      <td>1.928400e+04</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.470437</td>
      <td>2224.761599</td>
      <td>43.284272</td>
      <td>0.817107</td>
      <td>0.974246</td>
      <td>0.081000</td>
      <td>1.674178e+05</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.754534</td>
      <td>2106.974155</td>
      <td>12.576030</td>
      <td>0.548879</td>
      <td>1.421282</td>
      <td>0.272842</td>
      <td>1.030418e+05</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.000000</td>
      <td>24.141633</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.066726e+04</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>927.984311</td>
      <td>33.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.030161e+05</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>1630.019381</td>
      <td>42.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.450208e+05</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.000000</td>
      <td>2747.876441</td>
      <td>53.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>2.033700e+05</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5.000000</td>
      <td>18388.949901</td>
      <td>75.000000</td>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>2.265604e+06</td>
    </tr>
  </tbody>
</table>
</div>

## ✅ Предобработка данных

Что входит в перечень задач по очистке данных?

* `Очистка явных и неявных дубликатов`;
* `Аномальные значения`;
* `Пропустки`;
* `Опечатки`.

```python
df.duplicated().sum()
```


    np.int64(0)



```python
# Удалить дубликаты, если они есть:
df = df.drop_duplicates()
```

```python
# Уникальные значения в исполнение цикла:

for i in ['education', 'family_status', 'gender', 'income_type', 'purpose']:
    print(df[i].unique())
```

    ['высшее' 'среднее' 'неоконченное высшее' 'начальное' 'ученая степень']
    ['женат / замужем' 'гражданский брак' 'вдовец / вдова' 'в разводе'
     'не женат / не замужем']
    ['F' 'M']
    ['сотрудник' 'пенсионер' 'компаньон' 'госслужащий' 'безработный'
     'предприниматель' 'студент' 'в декрете']
    ['покупка жилья' 'приобретение автомобиля' 'дополнительное образование'
     'сыграть свадьбу' 'операции с жильем' 'образование'
     'на проведение свадьбы' 'покупка жилья для семьи' 'покупка недвижимости'
     'покупка коммерческой недвижимости' 'покупка жилой недвижимости'
     'строительство собственной недвижимости' 'недвижимость'
     'строительство недвижимости' 'на покупку подержанного автомобиля'
     'на покупку своего автомобиля' 'операции с коммерческой недвижимостью'
     'строительство жилой недвижимости' 'жилье'
     'операции со своей недвижимостью' 'автомобили' 'заняться образованием'
     'сделка с подержанным автомобилем' 'получение образования' 'автомобиль'
     'свадьба' 'получение дополнительного образования' 'покупка своего жилья'
     'операции с недвижимостью' 'получение высшего образования'
     'свой автомобиль' 'сделка с автомобилем' 'профильное образование'
     'высшее образование' 'покупка жилья для сдачи' 'на покупку автомобиля'
     'ремонт жилью' 'заняться высшим образованием']



```python
# Группировка по параметру "Дети"
print(df.groupby('children')["children"].count())
```

    children
    -1       47
     0    14107
     1     4809
     2     2052
     3      330
     4       41
     5        9
    Name: children, dtype: int64



```python
# Группировка по параметру "Дети"

df['children'].value_counts()
```


    children
     0    14107
     1     4809
     2     2052
     3      330
    -1       47
     4       41
     5        9
    Name: count, dtype: int64



```python
# Сортировка результата выдачи "1." от большего к меньшему по параметру "Кол-во детей": 

df["children"] = df["children"].replace(-1, 1)
```

```python
# Процентное соотношение детей < 18 лет

print (df[df['dob_years']<18]['dob_years'].count()/df['dob_years'].count()*100)
```

    0.4673989249824725



```python
ndf = df[df['dob_years'] >= 18]
```

```python
df.describe()
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education_id</th>
      <th>family_status_id</th>
      <th>debt</th>
      <th>total_income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>21395.000000</td>
      <td>19284.000000</td>
      <td>21395.000000</td>
      <td>21395.000000</td>
      <td>21395.000000</td>
      <td>21395.000000</td>
      <td>1.928400e+04</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.474831</td>
      <td>2224.761599</td>
      <td>43.284272</td>
      <td>0.817107</td>
      <td>0.974246</td>
      <td>0.081000</td>
      <td>1.674178e+05</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.751776</td>
      <td>2106.974155</td>
      <td>12.576030</td>
      <td>0.548879</td>
      <td>1.421282</td>
      <td>0.272842</td>
      <td>1.030418e+05</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>24.141633</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.066726e+04</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>927.984311</td>
      <td>33.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.030161e+05</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>1630.019381</td>
      <td>42.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.450208e+05</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.000000</td>
      <td>2747.876441</td>
      <td>53.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>2.033700e+05</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5.000000</td>
      <td>18388.949901</td>
      <td>75.000000</td>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>2.265604e+06</td>
    </tr>
  </tbody>
</table>
</div>

```python
# Привести все данные в нижний регистр

df['education'] = df['education'].str.lower()
```

```python
# Уникальные значения по гендеру

df['gender'].value_counts()
```


    gender
    F    14142
    M     7252
    Name: count, dtype: int64



```python
# Удаляем из гендера значение "Н/Д"

df = df[df['gender']!='XNA']
```

```python
def purposes(reason):
    if 'образов' in reason:
        return 'образование'
    if 'свадь' in reason:
        return 'свадьба'
    if 'авто' in reason:
        return 'автомобиль'
    if 'жиль' in reason:
        return 'недвижимость'
    if 'недвиж' in reason:
        return 'недвижимость'
```

```python
purposes('покупка жилья')
```


    'недвижимость'



```python
df['purposes_category'] = df['purpose'].apply(purposes)
```

```python
df.head(10)
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education</th>
      <th>education_id</th>
      <th>family_status</th>
      <th>family_status_id</th>
      <th>gender</th>
      <th>income_type</th>
      <th>debt</th>
      <th>total_income</th>
      <th>purpose</th>
      <th>purposes_category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>8437.673028</td>
      <td>42</td>
      <td>высшее</td>
      <td>0</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>253875.639453</td>
      <td>покупка жилья</td>
      <td>недвижимость</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>4024.803754</td>
      <td>36</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>112080.014102</td>
      <td>приобретение автомобиля</td>
      <td>автомобиль</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>5623.422610</td>
      <td>33</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>M</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>145885.952297</td>
      <td>покупка жилья</td>
      <td>недвижимость</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4124.747207</td>
      <td>32</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>M</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>267628.550329</td>
      <td>дополнительное образование</td>
      <td>образование</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1630.019381</td>
      <td>53</td>
      <td>среднее</td>
      <td>1</td>
      <td>гражданский брак</td>
      <td>1</td>
      <td>F</td>
      <td>пенсионер</td>
      <td>0</td>
      <td>158616.077870</td>
      <td>сыграть свадьбу</td>
      <td>свадьба</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>926.185831</td>
      <td>27</td>
      <td>высшее</td>
      <td>0</td>
      <td>гражданский брак</td>
      <td>1</td>
      <td>M</td>
      <td>компаньон</td>
      <td>0</td>
      <td>255763.565419</td>
      <td>покупка жилья</td>
      <td>недвижимость</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>2879.202052</td>
      <td>43</td>
      <td>высшее</td>
      <td>0</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>компаньон</td>
      <td>0</td>
      <td>240525.971920</td>
      <td>операции с жильем</td>
      <td>недвижимость</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>152.779569</td>
      <td>50</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>M</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>135823.934197</td>
      <td>образование</td>
      <td>образование</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2</td>
      <td>6929.865299</td>
      <td>35</td>
      <td>высшее</td>
      <td>0</td>
      <td>гражданский брак</td>
      <td>1</td>
      <td>F</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>95856.832424</td>
      <td>на проведение свадьбы</td>
      <td>свадьба</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
      <td>2188.756445</td>
      <td>41</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>M</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>144425.938277</td>
      <td>покупка жилья для семьи</td>
      <td>недвижимость</td>
    </tr>
  </tbody>
</table>
</div>

```python
# Проверка: Уникальных значений:

for i in ['education', 'family_status', 'gender', 'income_type', 'purposes_category']:
    print(df[i].unique())
```

    ['высшее' 'среднее' 'неоконченное высшее' 'начальное' 'ученая степень']
    ['женат / замужем' 'гражданский брак' 'вдовец / вдова' 'в разводе'
     'не женат / не замужем']
    ['F' 'M']
    ['сотрудник' 'пенсионер' 'компаньон' 'госслужащий' 'безработный'
     'предприниматель' 'студент' 'в декрете']
    ['недвижимость' 'автомобиль' 'образование' 'свадьба']



```python
df.isna().sum()
```


    children             0
    days_employed        0
    dob_years            0
    education            0
    education_id         0
    family_status        0
    family_status_id     0
    gender               0
    income_type          0
    debt                 0
    total_income         0
    purpose              0
    purposes_category    0
    dtype: int64



```python
# Поиск и замена значений в заданном диапазоне

df['days_employed'] = df['days_employed'].fillna(df['days_employed'].median())
```

```python
df
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education</th>
      <th>education_id</th>
      <th>family_status</th>
      <th>family_status_id</th>
      <th>gender</th>
      <th>income_type</th>
      <th>debt</th>
      <th>total_income</th>
      <th>purpose</th>
      <th>purposes_category</th>
      <th>purposes_caterogy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>8437.673028</td>
      <td>42</td>
      <td>высшее</td>
      <td>0</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>253875.639453</td>
      <td>покупка жилья</td>
      <td>недвижимость</td>
      <td>недвижимость</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>4024.803754</td>
      <td>36</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>112080.014102</td>
      <td>приобретение автомобиля</td>
      <td>автомобиль</td>
      <td>автомобиль</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>5623.422610</td>
      <td>33</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>M</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>145885.952297</td>
      <td>покупка жилья</td>
      <td>недвижимость</td>
      <td>недвижимость</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4124.747207</td>
      <td>32</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>M</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>267628.550329</td>
      <td>дополнительное образование</td>
      <td>образование</td>
      <td>образование</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1630.019381</td>
      <td>53</td>
      <td>среднее</td>
      <td>1</td>
      <td>гражданский брак</td>
      <td>1</td>
      <td>F</td>
      <td>пенсионер</td>
      <td>0</td>
      <td>158616.077870</td>
      <td>сыграть свадьбу</td>
      <td>свадьба</td>
      <td>свадьба</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>21390</th>
      <td>1</td>
      <td>4529.316663</td>
      <td>43</td>
      <td>среднее</td>
      <td>1</td>
      <td>гражданский брак</td>
      <td>1</td>
      <td>F</td>
      <td>компаньон</td>
      <td>0</td>
      <td>224791.862382</td>
      <td>операции с жильем</td>
      <td>недвижимость</td>
      <td>недвижимость</td>
    </tr>
    <tr>
      <th>21391</th>
      <td>0</td>
      <td>1630.019381</td>
      <td>67</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>пенсионер</td>
      <td>0</td>
      <td>155999.806512</td>
      <td>сделка с автомобилем</td>
      <td>автомобиль</td>
      <td>автомобиль</td>
    </tr>
    <tr>
      <th>21392</th>
      <td>1</td>
      <td>2113.346888</td>
      <td>38</td>
      <td>среднее</td>
      <td>1</td>
      <td>гражданский брак</td>
      <td>1</td>
      <td>M</td>
      <td>сотрудник</td>
      <td>1</td>
      <td>89672.561153</td>
      <td>недвижимость</td>
      <td>недвижимость</td>
      <td>недвижимость</td>
    </tr>
    <tr>
      <th>21393</th>
      <td>3</td>
      <td>3112.481705</td>
      <td>38</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>M</td>
      <td>сотрудник</td>
      <td>1</td>
      <td>244093.050500</td>
      <td>на покупку своего автомобиля</td>
      <td>автомобиль</td>
      <td>автомобиль</td>
    </tr>
    <tr>
      <th>21394</th>
      <td>2</td>
      <td>1984.507589</td>
      <td>40</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>82047.418899</td>
      <td>на покупку автомобиля</td>
      <td>автомобиль</td>
      <td>автомобиль</td>
    </tr>
  </tbody>
</table>
<p>21394 rows × 14 columns</p>
</div>

```python
# Цикл
# Поиск и замена пустых значений в заданном диапазоне

for i in df['income_type'].unique():
    df.loc[(df['income_type'] == i) & (df['total_income'].isna()), 'total_income'] = df.loc[(df['income_type'] == i), 'total_income'].median()
```

```python
df.duplicated().sum() # Проверка на наличие дубликатов
```


    np.int64(0)



```python
df = df.drop_duplicates() # Удаление дубликатов, если они есть
```

```python
df.head() # Обнаружен дубликат столбца "purposes_caterogy"
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education</th>
      <th>education_id</th>
      <th>family_status</th>
      <th>family_status_id</th>
      <th>gender</th>
      <th>income_type</th>
      <th>debt</th>
      <th>total_income</th>
      <th>purpose</th>
      <th>purposes_category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>8437.673028</td>
      <td>42</td>
      <td>высшее</td>
      <td>0</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>253875.639453</td>
      <td>покупка жилья</td>
      <td>недвижимость</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>4024.803754</td>
      <td>36</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>112080.014102</td>
      <td>приобретение автомобиля</td>
      <td>автомобиль</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>5623.422610</td>
      <td>33</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>M</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>145885.952297</td>
      <td>покупка жилья</td>
      <td>недвижимость</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4124.747207</td>
      <td>32</td>
      <td>среднее</td>
      <td>1</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>M</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>267628.550329</td>
      <td>дополнительное образование</td>
      <td>образование</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1630.019381</td>
      <td>53</td>
      <td>среднее</td>
      <td>1</td>
      <td>гражданский брак</td>
      <td>1</td>
      <td>F</td>
      <td>пенсионер</td>
      <td>0</td>
      <td>158616.077870</td>
      <td>сыграть свадьбу</td>
      <td>свадьба</td>
    </tr>
  </tbody>
</table>
</div>

```python
# df = df.drop(columns='purposes_caterogy')
# print(df)
```

```python
df.head(1) # Check
```



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>children</th>
      <th>days_employed</th>
      <th>dob_years</th>
      <th>education</th>
      <th>education_id</th>
      <th>family_status</th>
      <th>family_status_id</th>
      <th>gender</th>
      <th>income_type</th>
      <th>debt</th>
      <th>total_income</th>
      <th>purpose</th>
      <th>purposes_category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>8437.673028</td>
      <td>42</td>
      <td>высшее</td>
      <td>0</td>
      <td>женат / замужем</td>
      <td>0</td>
      <td>F</td>
      <td>сотрудник</td>
      <td>0</td>
      <td>253875.639453</td>
      <td>покупка жилья</td>
      <td>недвижимость</td>
    </tr>
  </tbody>
</table>
</div>

## Ответы на вопросы

### 4А.        ✅`Средняя зарплата по типу занятости`

```python
avg_income_by_type = df.groupby('income_type')['total_income'].mean()
print('Средняя зарплата по типу занятости: ', avg_income_by_type)
```

    Средняя зарплата по типу занятости:  income_type
    безработный        131339.751676
    в декрете           53829.130729
    госслужащий        168811.737769
    компаньон          199558.373308
    пенсионер          135266.515670
    предприниматель    499163.144947
    сотрудник          159533.471972
    студент             98201.625314
    Name: total_income, dtype: float64

### 4Б.        ✅`Процент заемщиков с высшим образованием`

```python
percent = df.groupby('education')['education'].count()/len(df)*100
percent
```


    education
    высшее                 24.493615
    начальное               1.319175
    неоконченное высшее     3.466342
    среднее                70.692801
    ученая степень          0.028068
    Name: education, dtype: float64



```python
print('Процент заемщиков с высшим образованием:', df[df['education'] == 'высшее']['education'].count()/df.shape[0]*100)
```

    Процент заемщиков с высшим образованием: 24.493614632549

### 4В.        ✅`Частота кредитов на покупку жилья`

```python
percent_category = df[df['purposes_category'] == 'недвижимость']['purposes_category'].count()/len(df)*100
print('Частота кредитов на покупку жилья', percent_category)
```

    Частота кредитов на покупку жилья 50.39996257660102

### 4Г.        ✅`Зависимость между семейным положением и задолженностью`

```python
family_debt = df.groupby('family_status')['debt'].mean().sort_values(ascending=False)
print("Доля должников по семейному положению:")
print((family_debt * 100).round(1))
```

    Доля должников по семейному положению:
    family_status
    не женат / не замужем    9.7
    гражданский брак         9.3
    женат / замужем          7.6
    в разводе                7.0
    вдовец / вдова           6.6
    Name: debt, dtype: float64

### 4Д.        ✅`Есть ли зависимость между количеством детей и возвратом кредита в срок?`

```python
children_debt = df.groupby('children')['debt'].mean().sort_values(ascending=False)
print("\nДоля должников по количеству детей:")
print((children_debt * 100).round(1))
```

    Доля должников по количеству детей:
    children
    4    9.8
    2    9.5
    1    9.2
    3    8.2
    0    7.5
    5    0.0
    Name: debt, dtype: float64

#### 4Д.         Выводы

1. 0 детей: 7.5% должников
2. 1 ребенок: 9.2% должников
3. 2 детей: 9.5% должников
4. 3 детей: 8.2% должников 🔴 Неожиданное снижение
5. 4 детей: 9.8% должников 🔴 МАКСИМАЛЬНЫЙ РИСК
6. 5 детей: 0.0% должников 🔴 МИНИМАЛЬНЫЙ РИСК (аномалия)

⚠ Зависимость существует, но она сложная и требует дополнительного исследования аномалий, особенно для 3 и 5 детей.

### 4Е.        ✅`Есть ли зависимость между уровнем дохода и возвратом кредита в срок?`

```python
df['income_quartile'] = pd.qcut(df['total_income'], 4, labels=['Q1', 'Q2', 'Q3', 'Q4'])
income_debt = df.groupby('income_quartile')['debt'].mean()
print("\nДоля должников по квартилям дохода:")
print((income_debt * 100).round(1))
```

    Доля должников по квартилям дохода:
    income_quartile
    Q1    8.0
    Q2    8.8
    Q3    8.5
    Q4    7.1
    Name: debt, dtype: float64
    
    
    C:\Users\Станислав\AppData\Local\Temp\ipykernel_30576\1315253979.py:2: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
      income_debt = df.groupby('income_quartile')['debt'].mean()

#### 4Е.         Выводы

Зависимость есть
