# –†–∞–±–æ—Ç–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ MS Excel. –ú–æ–¥—É–ª—å openpyxl

### ‚úÖ –ó–∞–¥–∞–Ω–∏—è 1 –Ω–∞ openpyxl (–¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Excel)

–ó–∞–¥–∞–Ω–∏–µ 1.1: –°–æ–∑–¥–∞–π –Ω–æ–≤—É—é –∫–Ω–∏–≥—É Excel
–£—Å–ª–æ–≤–∏–µ: –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π —Ñ–∞–π–ª Excel —Å –∏–º–µ–Ω–µ–º my_first_table.xlsx. –î–æ–±–∞–≤—å –ª–∏—Å—Ç —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º "–ü—Ä–æ–¥–∞–∂–∏". –í —è—á–µ–π–∫—É A1 –∑–∞–ø–∏—à–∏ "–¢–æ–≤–∞—Ä", –≤ B1 - "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ", –≤ C1 - "–¶–µ–Ω–∞". –°–æ—Ö—Ä–∞–Ω–∏ —Ñ–∞–π–ª.

–ó–∞–¥–∞–Ω–∏–µ 1.2: –ó–∞–ø–æ–ª–Ω–∏ —Ç–∞–±–ª–∏—Ü—É –¥–∞–Ω–Ω—ã–º–∏
–£—Å–ª–æ–≤–∏–µ: –í–æ–∑—å–º–∏ —Ñ–∞–π–ª –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è. –î–æ–±–∞–≤—å —Ç—Ä–∏ —Å—Ç—Ä–æ–∫–∏ —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ø–±–ª–æ–∫–∏, 100, 50; –ì—Ä—É—à–∏, 75, 70; –°–ª–∏–≤—ã, 50, 90). –°–æ—Ö—Ä–∞–Ω–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

–ó–∞–¥–∞–Ω–∏–µ 1.3: –ü—Ä–æ—á–∏—Ç–∞–π –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∞–π–ª–∞
–£—Å–ª–æ–≤–∏–µ: –ù–∞–ø–∏—à–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–∫—Ä–æ–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª my_first_table.xlsx, –ø—Ä–æ—á–∏—Ç–∞–µ—Ç –∏ –≤—ã–≤–µ–¥–µ—Ç –Ω–∞ —ç–∫—Ä–∞–Ω –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ "–¢–æ–≤–∞—Ä"



#### –†–µ—à–µ–Ω–∏—è –Ω–∞ –∑–∞–Ω—è—Ç–∏–∏


```python
import openpyxl
wb = openpyxl.Workbook()
wb.create_sheet(title = '–ü—Ä–æ–¥–∞–∂–∏', index = 0)
sheet = wb.active
sheet.append(['–¢–æ–≤–∞—Ä', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ', '–¶–µ–Ω–∞'])
wb.save('my_first_table_ksp.xlsx')
```


```python
wb = openpyxl.Workbook()
wb.create_sheet(title = '–ü—Ä–æ–¥–∞–∂–∏', index = 0)
sheet = wb.active
sheet['A1'] = '–¢–æ–≤–∞—Ä'
sheet['B1'] = '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ'
sheet['C1'] = '–¶–µ–Ω–∞'
wb.save('my_first_table_ksp.xlsx')
```


```python
wb = openpyxl.Workbook()
sheet = wb.active
sheet_title = sheet.title 
sheet_title =  "–ü—Ä–æ–¥–∞–∂–∏"
a1 = sheet.cell(row = 1, column = 1)
a1.value = "–¢–æ–≤–∞—Ä"
b1 = sheet.cell(row= 1 , column = 2)
b1.value = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ"
c1 = sheet.cell(row = 1, column = 3)
c1.value = "–¶–µ–Ω–∞"
wb.save("Analytics_2.xlsx")

from openpyxl import load_workbook

file_path = "Analytics_2.xlsx"
wb = load_workbook(file_path)

# –Ω–µ —Ä–∞–±–æ—á–∏–π –≤–∞—Ä–∏–∞–Ω—Ç: ‚ùåws = wb["–ü—Ä–æ–¥–∞–∂–∏"]
# –ó–∞–º–µ–Ω–∏ –Ω–∞: ‚úÖ
ws = wb.create_sheet("–ü—Ä–æ–¥–∞–∂–∏")

ws.append(["–Ø–±–ª–æ–∫–∏", 100, 50])
ws.append(["–ì—Ä—É—à–∏", 75, 70])
ws.append(["–°–ª–∏–≤—ã", 50, 90])

wb.save(file_path)

print("–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ñ–∞–π–ª:", file_path)
```

    –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ñ–∞–π–ª: Analytics_2.xlsx
    


```python
from openpyxl import load_workbook

file_path = "my_first_table_ksp.xlsx"
wb = load_workbook(file_path)

ws = wb["–ü—Ä–æ–¥–∞–∂–∏"]

ws.append(["–Ø–±–ª–æ–∫–∏", 100, 50])
ws.append(["–ì—Ä—É—à–∏", 75, 70])
ws.append(["–°–ª–∏–≤—ã", 50, 90])

wb.save(file_path)

print("–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ñ–∞–π–ª:", file_path)
```

    –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ñ–∞–π–ª: my_first_table_ksp.xlsx
    


```python
wb = openpyxl.load_workbook('my_first_table_ksp.xlsx')
sheet = wb.active
rows = sheet.max_row
cols = sheet.max_column
for i in range(1, rows + 1):
    for j in range(1, cols + 1):
        cell = sheet.cell(row = i, column = j)
        if cell.value == "–¢–æ–≤–∞—Ä":
            print(*[p.value for p in sheet[openpyxl.utils.get_column_letter(j)]])
            break
```

    –¢–æ–≤–∞—Ä –Ø–±–ª–æ–∫–∏ –ì—Ä—É—à–∏ –°–ª–∏–≤—ã
    


```python
wb = openpyxl.load_workbook('my_first_table_ksp.xlsx')
ws = wb['–ü—Ä–æ–¥–∞–∂–∏']
print('–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤')
for row in range(2, ws.max_row+1):
    product_name = ws[f'A{row}'].value
    print(f' - {product_name}')
```

    –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
     - –Ø–±–ª–æ–∫–∏
     - –ì—Ä—É—à–∏
     - –°–ª–∏–≤—ã
    


```python
wb = openpyxl.load_workbook('my_first_table_ksp.xlsx')
sheet = wb.active
for row in sheet['A2':'A4']:
    string = ''
    for cell in row:
        string = string + str(cell.value) + ' '
    print(string)
```

    –Ø–±–ª–æ–∫–∏ 
    –ì—Ä—É—à–∏ 
    –°–ª–∏–≤—ã 
    

#### üîç –í–∞—Ä–∏–∞–Ω—Ç —Ä–µ—à–µ–Ω–∏—è –æ—Ç –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ –¥–ª—è —Ä–∞–∑–±–æ—Ä–∞


```python
from openpyxl import Workbook

# –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∫–Ω–∏–≥—É
wb = Workbook()

# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –ª–∏—Å—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–Ω —É–∂–µ —Å–æ–∑–¥–∞–Ω)
ws = wb.active
ws.title = "–ü—Ä–æ–¥–∞–∂–∏"  # –ú–µ–Ω—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞

# –ó–∞–ø–æ–ª–Ω—è–µ–º —à–∞–ø–∫—É —Ç–∞–±–ª–∏—Ü—ã
ws['A1'] = '–¢–æ–≤–∞—Ä'
ws['B1'] = '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ'
ws['C1'] = '–¶–µ–Ω–∞'

# –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª
wb.save('my_first_table.xlsx')
```


```python
from openpyxl import load_workbook

# –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª
wb = load_workbook('my_first_table.xlsx')
ws = wb['–ü—Ä–æ–¥–∞–∂–∏']  # –í—ã–±–∏—Ä–∞–µ–º –ª–∏—Å—Ç –ø–æ –∏–º–µ–Ω–∏

# –î–∞–Ω–Ω—ã–µ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (—Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤)
data = [
    ['–Ø–±–ª–æ–∫–∏', 100, 50],
    ['–ì—Ä—É—à–∏', 75, 70],
    ['–°–ª–∏–≤—ã', 50, 90]
]

# –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ, –Ω–∞—á–∏–Ω–∞—è —Å–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏ (–ø–æ—Å–ª–µ —à–∞–ø–∫–∏)
for i, row_data in enumerate(data, start=2):
    ws[f'A{i}'] = row_data[0]
    ws[f'B{i}'] = row_data[1]
    ws[f'C{i}'] = row_data[2]

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
wb.save('my_first_table.xlsx')
```


```python
from openpyxl import load_workbook

# –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª
wb = load_workbook('my_first_table.xlsx')
ws = wb['–ü—Ä–æ–¥–∞–∂–∏']

# –ß–∏—Ç–∞–µ–º –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ A, –Ω–∞—á–∏–Ω–∞—è —Å–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏ (—á—Ç–æ–±—ã –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫)
print("–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤:")
for row in range(2, ws.max_row + 1):
    product_name = ws[f'A{row}'].value
    print(f"- {product_name}")
```

    –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤:
    - –Ø–±–ª–æ–∫–∏
    - –ì—Ä—É—à–∏
    - –°–ª–∏–≤—ã
    

### ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 2 –Ω–∞ docx (–¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Word)

–ó–∞–¥–∞–Ω–∏–µ 2.1: –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
–£—Å–ª–æ–≤–∏–µ: –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç Word —Å –∏–º–µ–Ω–µ–º my_document.docx. –î–æ–±–∞–≤—å –≤ –Ω–µ–≥–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ "–ú–æ–π –ø–µ—Ä–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç" –∏ –ø–∞—Ä–∞–≥—Ä–∞—Ñ —Å —Ç–µ–∫—Å—Ç–æ–º "–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä! –≠—Ç–æ –º–æ–π –ø–µ—Ä–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å –ø–æ–º–æ—â—å—é Python." –°–æ—Ö—Ä–∞–Ω–∏ —Ñ–∞–π–ª.

–ó–∞–¥–∞–Ω–∏–µ 2.2: –ò–∑–º–µ–Ω–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–£—Å–ª–æ–≤–∏–µ: –û—Ç–∫—Ä–æ–π –¥–æ–∫—É–º–µ–Ω—Ç –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è. –°–¥–µ–ª–∞–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∂–∏—Ä–Ω—ã–º –∏ –≤—ã—Ä–æ–≤–Ω—è–π –µ–≥–æ –ø–æ —Ü–µ–Ω—Ç—Ä—É. –¢–µ–∫—Å—Ç –≤ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–µ —Å–¥–µ–ª–∞–π –∫—É—Ä—Å–∏–≤–Ω—ã–º. –°–æ—Ö—Ä–∞–Ω–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

–ó–∞–¥–∞–Ω–∏–µ 2.3: –ü—Ä–æ—á–∏—Ç–∞–π –¥–æ–∫—É–º–µ–Ω—Ç
–£—Å–ª–æ–≤–∏–µ: –ù–∞–ø–∏—à–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–∫—Ä–æ–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç my_document.docx –∏ –≤—ã–≤–µ–¥–µ—Ç –≤–µ—Å—å –µ–≥–æ —Ç–µ–∫—Å—Ç –≤ –∫–æ–Ω—Å–æ–ª—å.

#### –†–µ—à–µ–Ω–∏—è –Ω–∞ –∑–∞–Ω—è—Ç–∏–∏


```python
import docx
new_doc = docx.Document()
new_doc.add_heading('–ú–æ–π –ø–µ—Ä–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç', 0)
new_doc.add_paragraph(text = '–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä! –≠—Ç–æ –º–æ–π –ø–µ—Ä–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å –ø–æ–º–æ—â—å—é Python')
new_doc.save('my_first_doc_ksp.docx')
```


```python
from docx import Document
from docx.shared import Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH
from docx.oxml.ns import qn

doc = Document('my_first_doc_ksp.docx')
if len(doc.paragraphs) > 0:
    heading = doc.paragraphs[0]
for run in heading.runs:
    run.bold = True
heading.alignment = WD_ALIGN_PARAGRAPH.CENTER
if len(doc.paragraphs) > 1:
    paragraph = doc.paragraphs[1]
for run in paragraph.runs:
    run.italic = True
doc.save('my_first_doc_ksp.docx')
```


```python
from docx import Document

doc = Document("my_first_doc_ksp.docx")

for para in doc.paragraphs:
    print(para.text)
```

    –ú–æ–π –ø–µ—Ä–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
    –ü—Ä–∏–≤–µ—Ç, –º–∏—Ä! –≠—Ç–æ –º–æ–π –ø–µ—Ä–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å –ø–æ–º–æ—â—å—é Python
    

#### üîç –í–∞—Ä–∏–∞–Ω—Ç —Ä–µ—à–µ–Ω–∏—è –æ—Ç –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ –¥–ª—è —Ä–∞–∑–±–æ—Ä–∞


```python
from docx import Document

# –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
doc = Document()

# –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ (—É—Ä–æ–≤–µ–Ω—å 0 - —Å–∞–º—ã–π –∫—Ä—É–ø–Ω—ã–π)
doc.add_heading('–ú–æ–π –ø–µ—Ä–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç', 0)

# –î–æ–±–∞–≤–ª—è–µ–º –ø–∞—Ä–∞–≥—Ä–∞—Ñ —Å —Ç–µ–∫—Å—Ç–æ–º
doc.add_paragraph('–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä! –≠—Ç–æ –º–æ–π –ø–µ—Ä–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å –ø–æ–º–æ—â—å—é Python.')

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–æ–∫—É–º–µ–Ω—Ç
doc.save('my_document.docx')
```


```python
from docx import Document
from docx.enum.text import WD_ALIGN_PARAGRAPH
from docx.shared import Pt

# –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –¥–æ–∫—É–º–µ–Ω—Ç
doc = Document('my_document.docx')

# –ü–µ—Ä–≤—ã–π –ø–∞—Ä–∞–≥—Ä–∞—Ñ - —ç—Ç–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫
heading = doc.paragraphs[0]
heading.alignment = WD_ALIGN_PARAGRAPH.CENTER  # –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ —Ü–µ–Ω—Ç—Ä—É

# –í—Ç–æ—Ä–æ–π –ø–∞—Ä–∞–≥—Ä–∞—Ñ - —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç
main_text = doc.paragraphs[1]

# –ú–µ–Ω—è–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Å–µ–≥–æ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞
for run in main_text.runs:
    run.italic = True  # –î–µ–ª–∞–µ–º –∫—É—Ä—Å–∏–≤–æ–º

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
doc.save('my_document.docx')
```


```python
from docx import Document

# –û—Ç–∫—Ä—ã–≤–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç
doc = Document('my_document.docx')

# –ß–∏—Ç–∞–µ–º –∏ –≤—ã–≤–æ–¥–∏–º –≤–µ—Å—å —Ç–µ–∫—Å—Ç
full_text = []
for paragraph in doc.paragraphs:
    full_text.append(paragraph.text)

# –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ—ã –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É —Å –ø–µ—Ä–µ–Ω–æ—Å–∞–º–∏
print('\n'.join(full_text))
```

    –ú–æ–π –ø–µ—Ä–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
    –ü—Ä–∏–≤–µ—Ç, –º–∏—Ä! –≠—Ç–æ –º–æ–π –ø–µ—Ä–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å –ø–æ–º–æ—â—å—é Python.
    

### ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 3. –ê–Ω–∞–ª–∏–∑ –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–æ–¥–∞–∂

–£—Å–ª–æ–≤–∏–µ: –ù–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∞–π–ª–∞ my_first_table.xlsx –≤—ã–ø–æ–ª–Ω–∏ —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:

–î–æ–±–∞–≤—å –Ω–æ–≤—É—é –∫–æ–ª–æ–Ω–∫—É "–°—É–º–º–∞" (D1), –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å—Å—è –∫–∞–∫ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ * –¶–µ–Ω–∞

–ó–∞–ø–æ–ª–Ω–∏ —ç—Ç—É –∫–æ–ª–æ–Ω–∫—É –¥–ª—è –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤

–î–æ–±–∞–≤—å –∏—Ç–æ–≥–æ–≤—É—é —Å—Ç—Ä–æ–∫—É "–ò—Ç–æ–≥–æ" –≤ –∫–æ–Ω—Ü–µ —Ç–∞–±–ª–∏—Ü—ã, –∫–æ—Ç–æ—Ä–∞—è –ø–æ—Å—á–∏—Ç–∞–µ—Ç –æ–±—â—É—é —Å—É–º–º—É –ø—Ä–æ–¥–∞–∂

–ü–æ–¥—Å—á–∏—Ç–∞–π –∏ –≤—ã–≤–µ–¥–∏ –≤ –∫–æ–Ω—Å–æ–ª—å —Å—Ä–µ–¥–Ω—é—é —Ü–µ–Ω—É —Ç–æ–≤–∞—Ä–æ–≤

–°–æ—Ö—Ä–∞–Ω–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –Ω–æ–≤—ã–π —Ñ–∞–π–ª sales_report.xlsx

#### –í –ù–ê–ß–ê–õ–ï –ü–û–ü–†–û–ë–û–í–ê–¢–¨ –†–ï–®–ò–¢–¨ –°–ê–ú–û–°–¢–û–Ø–¢–ï–õ–¨–ù–û


```python
from openpyxl import load_workbook
from openpyxl.styles import Font

# –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª
wb = load_workbook('my_first_table_ksp.xlsx')
ws = wb['–ü—Ä–æ–¥–∞–∂–∏']

# 1. –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –Ω–æ–≤–æ–π –∫–æ–ª–æ–Ω–∫–∏
ws['D1'] = '–°—É–º–º–∞'

# 2. –ó–∞–ø–æ–ª–Ω—è–µ–º –∫–æ–ª–æ–Ω–∫—É "–°—É–º–º–∞" –¥–ª—è –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤
total_sum = 0
total_price = 0
item_count = 0

for row in range(2, ws.max_row + 1):
    quantity = ws[f'B{row}'].value
    price = ws[f'C{row}'].value
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –ø—É—Å—Ç—ã–µ
    if quantity is not None and price is not None:
        amount = quantity * price
        ws[f'D{row}'] = amount
        total_sum += amount
        total_price += price
        item_count += 1

# 3. –î–æ–±–∞–≤–ª—è–µ–º –∏—Ç–æ–≥–æ–≤—É—é —Å—Ç—Ä–æ–∫—É
next_row = ws.max_row + 1
ws[f'A{next_row}'] = '–ò—Ç–æ–≥–æ'
ws[f'D{next_row}'] = total_sum


# 4. –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∏ –≤—ã–≤–æ–¥–∏–º —Å—Ä–µ–¥–Ω—é—é —Ü–µ–Ω—É
if item_count > 0:
    average_price = total_price / item_count
    print(f"–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞: {average_price:.2f} —Ä—É–±.")
else:
    print("–í —Ç–∞–±–ª–∏—Ü–µ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞")

# 5. –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –Ω–æ–≤—ã–π —Ñ–∞–π–ª
wb.save('sales_report_ksp.xlsx')
```

    –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞: 70.00 —Ä—É–±.
    

### ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 4. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ (–ø–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)

–£—Å–ª–æ–≤–∏–µ: –ù–∞–ø–∏—à–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è:

–û—Ç–∫—Ä–æ–µ—Ç —Ñ–∞–π–ª sales_report.xlsx

–ù–∞–π–¥–µ—Ç —Ç–æ–≤–∞—Ä —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º–æ–π –ø—Ä–æ–¥–∞–∂

–ù–∞–π–¥–µ—Ç —Ç–æ–≤–∞—Ä —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π

–ù–∞–π–¥–µ—Ç —Å–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –æ—Ç—á–µ—Ç–µ

–í—ã–≤–µ–¥–µ—Ç —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –∫–æ–Ω—Å–æ–ª—å



#### –í –ù–ê–ß–ê–õ–ï –ü–û–ü–†–û–ë–û–í–ê–¢–¨ –†–ï–®–ò–¢–¨ –°–ê–ú–û–°–¢–û–Ø–¢–ï–õ–¨–ù–û


```python
from openpyxl import load_workbook

def analyze_sales():
    wb = load_workbook('sales_report_ksp.xlsx')
    ws = wb['–ü—Ä–æ–¥–∞–∂–∏']
    
    max_amount = 0
    max_amount_product = ""
    min_price_product = ""
    min_price = float('inf')
    
    # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –∏—Ç–æ–≥–æ–≤—É—é —Å—Ç—Ä–æ–∫—É
    for row in range(2, ws.max_row):
        product = ws[f'A{row}'].value
        price = ws[f'C{row}'].value
        amount = ws[f'D{row}'].value
        
        if product and price is not None and amount is not None:
            # –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º–æ–π
            if amount > max_amount:
                max_amount = amount
                max_amount_product = product
            
            # –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π
            if price < min_price:
                min_price = price
                min_price_product = product
    
    print("–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥–∞–∂:")
    print(f"–¢–æ–≤–∞—Ä —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º–æ–π –ø—Ä–æ–¥–∞–∂: {max_amount_product} ({max_amount} —Ä—É–±.)")
    print(f"–¢–æ–≤–∞—Ä —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π: {min_price_product} ({min_price} —Ä—É–±. –∑–∞ —à—Ç.)")
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    total_items = ws.max_row - 2  # –±–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏ –∏—Ç–æ–≥–æ–≤
    print(f"–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –æ—Ç—á–µ—Ç–µ: {total_items}")

# –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∞–ª–∏–∑
analyze_sales()
```

    –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥–∞–∂:
    –¢–æ–≤–∞—Ä —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º–æ–π –ø—Ä–æ–¥–∞–∂: –ì—Ä—É—à–∏ (5250 —Ä—É–±.)
    –¢–æ–≤–∞—Ä —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π: –Ø–±–ª–æ–∫–∏ (50 —Ä—É–±. –∑–∞ —à—Ç.)
    –í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –æ—Ç—á–µ—Ç–µ: 3
    
